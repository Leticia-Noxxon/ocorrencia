<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro de Ocorrências</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f9;
    }
    h1, h2 {
      text-align: center;
    }
    .form-container, .ocorrencias-container {
      margin-bottom: 20px;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #003366;
      color: white;
      padding: 6px 12px;
      font-size: 13px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #002244;
    }
    .ocorrencias-wrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: flex-start;
    }
    .ocorrencia {
      background-color: #f9f9f9;
      padding: 10px;
      border-radius: 5px;
      width: 300px;
      height: 280px;
      overflow: hidden;
      box-sizing: border-box;
      position: relative;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }
    .ocorrencia span {
      display: block;
      font-weight: bold;
    }
    .button-group {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      gap: 5px;
    }
    .button-group button {
      flex: 1;
      padding: 6px 8px;
      font-size: 12px;
    }
    .filtros {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }
    .filtros-left {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .filtros select {
      width: auto;
      padding: 6px 10px;
      font-size: 14px;
      min-width: 180px;
      border-radius: 5px;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    #redefinirFiltro {
      color: #888;
      cursor: pointer;
      font-size: 14px;
      user-select: none;
    }
    #redefinirFiltro:hover {
      text-decoration: underline;
    }

    /* Bolinha de status */
    .bolinha {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      position: absolute;
      top: 10px;
      right: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.3);
    }
    .bolinha.verde {
      background-color: #00ff00;
      box-shadow: 0 0 8px #00ff00;
    }
    .bolinha.vermelha {
      background-color: #ff0000;
      box-shadow: 0 0 8px #ff0000;
    }
  </style>
</head>
<body>

  <h1>Registro de Ocorrências</h1>

  <div class="form-container">
    <h2>Cadastrar Nova Ocorrência</h2>
    <form id="ocorrenciaForm">
      <input type="text" id="cliente" placeholder="Nome do Cliente" required />
      <input type="date" id="data" required />

      <select id="garagem" required>
        <option value="">Selecione a Garagem</option>
        <option>A2 Transportes</option>
        <option>Alfa Rodobus</option>
        <option>Gato Preto - Portinari</option>
        <option>Gato Preto - Mackenzie</option>
        <option>MobiBrasil Alvarenga</option>
        <option>MobiBrasil Jabaquara</option>
        <option>Norte Buss A1</option>
        <option>Norte Buss A2</option>
        <option>Sambaiba G1</option>
        <option>Sambaiba G3</option>
        <option>Sambaiba G4</option>
        <option>Santa Brigida Mangalot</option>
        <option>Santa Brigida Jaguara</option>
        <option>Trans União D3</option>
        <option>Trans União D7</option>
        <option>UPBus</option>
        <option>Via Sudeste Cursino</option>
        <option>Via Sudeste Sapopemba</option>
        <option>Viação Grajaú</option>
        <option>Viação Metrópole AE Carvalho</option>
        <option>Viação Metrópole Brás</option>
        <option>Viação Metrópole Iguatemi</option>
        <option>Viação Metrópole Imperador</option>
        <option>Viação Metrópole Itaim</option>
        <option>Viação Metrópole M'Boi Mirim</option>
        <option>Metrópole Pinedo</option>
      </select>

      <select id="tema" required>
        <option value="">Selecione o Tema</option>
        <option>Telemetria</option>
        <option>Software</option>
        <option>Integração com Validador</option>
        <option>TP/TS</option>
        <option>Perca de Partida</option>
        <option>CFTV</option>
        <option>UCP NX6000</option>
        <option>TDM NX6010</option>
        <option>Falta de Equipamentos</option>
      </select>

      <textarea id="descricao" placeholder="Descrição da Reclamação" required></textarea>

      <label for="solucao">Teve solução?</label>
      <select id="solucao" required onchange="toggleDescricaoSolucao(this.value)">
        <option value="">Selecione</option>
        <option value="Sim">Sim</option>
        <option value="Não">Não</option>
      </select>

      <textarea id="descricaoSolucao" placeholder="Descreva a solução" style="display:none;"></textarea>

      <button type="submit">Adicionar Ocorrência</button>
    </form>
  </div>

  <div class="ocorrencias-container">
    <h2>Ocorrências Registradas</h2>
    <div class="filtros">
      <div class="filtros-left">
        <select id="filtroGaragem" onchange="carregarOcorrencias()">
          <option value="">Garagem</option>
          <option>A2 Transportes</option>
          <option>Alfa Rodobus</option>
          <option>Gato Preto - Portinari</option>
          <option>Gato Preto - Mackenzie</option>
          <option>MobiBrasil Alvarenga</option>
          <option>MobiBrasil Jabaquara</option>
          <option>Norte Buss A1</option>
          <option>Norte Buss A2</option>
          <option>Sambaiba G1</option>
          <option>Sambaiba G3</option>
          <option>Sambaiba G4</option>
          <option>Santa Brigida Mangalot</option>
          <option>Santa Brigida Jaguara</option>
          <option>Trans União D3</option>
          <option>Trans União D7</option>
          <option>UPBus</option>
          <option>Via Sudeste Cursino</option>
          <option>Via Sudeste Sapopemba</option>
          <option>Viação Grajaú</option>
          <option>Viação Metrópole AE Carvalho</option>
          <option>Viação Metrópole Brás</option>
          <option>Viação Metrópole Iguatemi</option>
          <option>Viação Metrópole Imperador</option>
          <option>Viação Metrópole Itaim</option>
          <option>Viação Metrópole M'Boi Mirim</option>
          <option>Metrópole Pinedo</option>
        </select>

        <select id="filtroTema" onchange="carregarOcorrencias()">
          <option value="">Tema</option>
          <option>Telemetria</option>
          <option>Software</option>
          <option>Integração com Validador</option>
          <option>TP/TS</option>
          <option>Perca de Partida</option>
          <option>CFTV</option>
          <option>UCP NX6000</option>
          <option>TDM NX6010</option>
          <option>Falta de Equipamentos</option>
        </select>
      </div>
      <span id="redefinirFiltro" onclick="resetarFiltros()">Redefinir Filtro</span>
    </div>
    <div id="ocorrenciasList" class="ocorrencias-wrapper"></div>
  </div>

  <script>
    function toggleDescricaoSolucao(valor) {
      document.getElementById('descricaoSolucao').style.display = valor === 'Sim' ? 'block' : 'none';
    }

    function carregarOcorrencias() {
      const filtroGaragem = document.getElementById('filtroGaragem').value;
      const filtroTema = document.getElementById('filtroTema').value;
      const ocorrencias = JSON.parse(localStorage.getItem('ocorrencias')) || [];
      const ocorrenciasList = document.getElementById('ocorrenciasList');
      ocorrenciasList.innerHTML = '';

      const filtradas = ocorrencias.filter(o => {
        return (!filtroGaragem || o.garagem === filtroGaragem) &&
               (!filtroTema || o.tema === filtroTema);
      });

      filtradas.forEach((ocorrencia, index) => {
        const div = document.createElement('div');
        div.classList.add('ocorrencia');

        const corBolinha = ocorrencia.solucao === "Sim" ? "verde" : "vermelha";

        div.innerHTML = `
          <div class="bolinha ${corBolinha}"></div>
          <span>Cliente: ${ocorrencia.cliente}</span>
          <span>Data: ${ocorrencia.data}</span>
          <span>Garagem: ${ocorrencia.garagem}</span>
          <span>Tema: ${ocorrencia.tema}</span>
          <p>${ocorrencia.descricao}</p>
          <span>Solução: ${ocorrencia.solucao}</span>
          ${ocorrencia.solucao === "Sim" ? `<p><strong>Descrição da Solução:</strong> ${ocorrencia.descricaoSolucao || ""}</p>` : ""}
          <div class="button-group">
            <button onclick="visualizarOcorrencia(${index})">Visualizar</button>
            <button onclick="editarOcorrencia(${index})">Editar</button>
            <button onclick="removerOcorrencia(${index})">Remover</button>
          </div>
        `;
        ocorrenciasList.appendChild(div);
      });
    }

    function resetarFiltros() {
      document.getElementById('filtroGaragem').value = '';
      document.getElementById('filtroTema').value = '';
      carregarOcorrencias();
    }

    document.getElementById('ocorrenciaForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const cliente = document.getElementById('cliente').value;
      const data = document.getElementById('data').value;
      const garagem = document.getElementById('garagem').value;
      const tema = document.getElementById('tema').value;
      const descricao = document.getElementById('descricao').value;
      const solucao = document.getElementById('solucao').value;
      const descricaoSolucao = document.getElementById('descricaoSolucao').value;

      const ocorrencia = {
        cliente,
        data,
        garagem,
        tema,
        descricao,
        solucao,
        descricaoSolucao: solucao === "Sim" ? descricaoSolucao : ""
      };

      const ocorrencias = JSON.parse(localStorage.getItem('ocorrencias')) || [];
      ocorrencias.push(ocorrencia);
      localStorage.setItem('ocorrencias', JSON.stringify(ocorrencias));

      this.reset();
      toggleDescricaoSolucao("Não");
      carregarOcorrencias();
    });

    function removerOcorrencia(index) {
      const ocorrencias = JSON.parse(localStorage.getItem('ocorrencias')) || [];
      ocorrencias.splice(index, 1);
      localStorage.setItem('ocorrencias', JSON.stringify(ocorrencias));
      carregarOcorrencias();
    }

    function editarOcorrencia(index) {
      const ocorrencias = JSON.parse(localStorage.getItem('ocorrencias')) || [];
      const o = ocorrencias[index];
      document.getElementById('cliente').value = o.cliente;
      document.getElementById('data').value = o.data;
      document.getElementById('garagem').value = o.garagem;
      document.getElementById('tema').value = o.tema;
      document.getElementById('descricao').value = o.descricao;
      document.getElementById('solucao').value = o.solucao;
      toggleDescricaoSolucao(o.solucao);
      document.getElementById('descricaoSolucao').value = o.descricaoSolucao || '';
      removerOcorrencia(index);
    }

    function visualizarOcorrencia(index) {
      const ocorrencias = JSON.parse(localStorage.getItem('ocorrencias')) || [];
      const o = ocorrencias[index];
      alert(`Cliente: ${o.cliente}\nData: ${o.data}\nGaragem: ${o.garagem}\nTema: ${o.tema}\nDescrição: ${o.descricao}\nSolução: ${o.solucao}\n${o.solucao === "Sim" ? "Descrição da Solução: " + (o.descricaoSolucao || "") : ""}`);
    }

    carregarOcorrencias();
  </script>

</body>
</html>



